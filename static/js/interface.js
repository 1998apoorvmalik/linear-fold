if ($('#seqInput').text() == ''){
    $('#seqInput').css('color', 'lightgrey');
    $('#submit').prop('disabled', true);
}

function update_textarea(e){
    e.style.color='black';
    $('#submit').prop('disabled', false);
}

$('#seqFile').bind('change', function () {
//function loaded(){
  var filename = $("#seqFile").val();
  console.log(filename);
  if (/^\s*$/.test(filename)) {
    $(".file-upload").removeClass('active');
    $("#noFile").text("No file chosen...");
  }
  else {
    $(".file-upload").addClass('active');
    //$("#noFile").text(filename);
    $("#noFile").text(filename.replace("C:\\fakepath\\", ""));

    var form_data = new FormData($('#seqFile')[0]);
    console.log(form_data);
    $.ajax({
        type: 'POST',
        url: '/uploadajax',
        data: form_data,
        contentType: false,
        cache: false,
        processData: false,
        async: true,
        //async: false,
        success: function(data) {
            console.log('Success!');
        },
     });
  }
//}
});


$('#constrBox').change(function(){
    var lst = $('#seqInput').val().split('\n');
    //var initial_seq1 = 'GGUUAAGCGACUAAGCGUACACGGUGGAUGCCCUGGCAGUCAGAGGCGAUGAAGG';
    var initial_seq1 = 'GCUCUGUUGGUGUAGUCCGGCCAAUCAUAUCACCCUCU';
    var initial_seq2 = 'AACUCCGCCAGGCCUGGAAGGGAGCAACGGUAGUGACACUCUCUGUGUGCGUAGGUUGCCUAGCUACCAUUU';
    var initial_con2 = '??(????????????(????????)???(??????(???????)?)???????????)??.???????????';
    if (this.checked){
        seqL = lst[1].length;
        if (lst[1] == initial_seq1){
            $('#seqInput').val(">name_with_constraints\n"+initial_seq2+"\n"+initial_con2);
        } else {
            $('#seqInput').val(lst[0]+'\n'+lst[1]+'\n'+('?'.repeat(seqL)));
            console.log('adding ? * '+ seqL + ' as constraints');
        }
        $('#constrant_intro').show();
        $('#zukerBox').prop("checked", false);
        $('#zukerBox').prop("disabled", true);
        $('#zukerDeltaLine').hide();
    }else{
        if (lst[1] == initial_seq2){
            $('#seqInput').val(">name\n"+initial_seq1);
        } else {
            $('#seqInput').val(lst[0]+'\n'+lst[1]);
        }
        $('#constrant_intro').hide()
        $('#zukerBox').prop("disabled", false);
    }
});


$('#zukerBox').change(function(){
    if (this.checked){
        $('#zukerDeltaLine').show();
    }else{
        $('#zukerDeltaLine').hide();
    }
});


function sampleInput(idx){
    var seqs = ['>tRNA_tdbR00000566-Homo_sapiens-9606-Tyr-9PA \nCCUUCGAUAGCUCAGCUGGUAGAGCGGAGGACUGUAGAUCCUUAGGUCGCUGGUUCGAUUCCGGCUCGAAGGACCA',
                //'>tRNA_tdbR00000042-Haloferax_volcanii-2246-Glu-MUC.ct \nGCUCUGUUGGUGUAGUCCGGCCAAUCAUAUCACCCUCUCACGGUGAUGACCAGGGUUCGAAUCCCUGACGGAGCACCA',
                '>SRP_Oryz.sati._AC079888 \nGCCGAGCCAGGUAGCGUUGGCUUGUCACCCGAGCGGGGGCAAUAAGGUGGUGUUGGAUGCCUGGUCGUUUGCGCUUGGGGUCUGCGCCUGUGGUUUGCACUAUGCGGCCCGCCCGUUCCAAGUUGCGUAGCGUGUGUGGGGCGCCUGGGCGAAGGCUCGAGCGUCCCUGCACCUAGAGUGGCGGGUAUUGCGUGAGGCUGGUUUCACAGAGCAGCGAGUACCGCCCGCUUCCAACGGUGGAAGGAUAACGGGCCGCUGCAGCCCUGGCCCGCUUCCGGCCCAAGUGCCUUCCAUGGCAGACCACCACCUUU',
                '>16S rRNA_A.pyrophilus \nUUCCCUGAAGAGUUUGAUCCUGGCUCAGCGCGAACGCUGGCGGCGUGCCUAACACAUGCAAGUCGUGCGCAGGCUCGCUCCCUCUGGGAGCGGGUGCUGAGCGGCAAACGGGUGAGUAACACGUGGGUAACCUACCCCCAGGAGGGGGAUAACCCCGGGAAACCGGGGCUAAUACCCCAUAAAGCCGCCCGCCACUAAGGCGAGGCGGCCAAAGGGGGCCUCUGGGCUCUGCCCAAGCUCCCGCCUGGGGAUGGGCCCGCGGCCCAUCAGGUAGUUGGUGGGGUAACGGCCCACCAAGCCUAUGACGGGUAGCCGGCCUGAGAGGGUGGCCGGCCACAGCGGGACUGAGACACGGCCCGCACCCCUACGGGGGGCAGCAGUGGGGAAUCGUGGGCAAUGGGCGAAAGCCUGACCCCGCGACGCCGCGUGGGGGAAGAAGCCCUGCGGGGUGUAAACCCCUGUCGGGGGGGACGAAGGGACUGUGGGUUAAUAGCCCACAGUCUUGACGGUACCCCCAGAGGAAGGGACGGCUAACUACGUGCCAGCAGCCGCGGUAAUACGUAGGUCCCGAGCGUUGCGCGAAGUCACUGGGCGUAAAGCGUCCGCAGCCGGUCGGGUAAGCGGGAUGUCAAAGCCCACGGCUCAACCGUGGAAUGGCAUCCCGAACUGCCCGACUUGAGGCACGCCCGGGCAGGCGGAAUUCCCGGGGUAGCGGUGAAAUGCGUAGAUCUCGGGAGGAACACCGAAGGGGAAGCCAGCCUGCUGGGGCUGUCCUGACGGUCAGGGACGAAAGCCGGGGGAGCGAACCGGAUUAGAUACCCGGGUAGUCCCGGCCGUAAACCAUGGGCGCUAGGGCUUGUCCCUUUGGGGCAGGCUCGCAGCUAACGCGUUAAGCGCCCCGCCUGGGGAGUACGGGCGCAAGCCUGAAACUCAAAGGAAUUGGCGGGGGCCCGCACAACCGGUGGAGCGUCUGGUUCAAUUCGAUGCUAACCGAAGAACCUUACCCGGGCUUGACAUGCCGGGGAGACUCCGCGAAAGCGGAGUUGUGGAAGUCUCUGACUUCCCCCCGGCACAGGUGGUGCAUGGCCGUCGUCAGCUCGUGUCGUGAGAUGUUGGGUUAAGUCCCGCAACGAGCGCAACCCCUGCCCCUAGUUGCUACCCCGAGAGGGGAGCACUCUAGGGGGACCGCCGGCGAUAAGCCGGAGGAAGGGGGGGAUGACGUCAGGUCAGUAUGCCCUUUAUGCCCGGGGCCACACAGGCGCUACAGUGGCCGGGACAAUGGGAAGCGACCCCGCAAGGGGGAGCUAAUCCCAGAAACCCGGUCAUGGUGCGGAUUGGGGGCUGAAACUCGCCCCCAUGAAGCCGGAAUCGGUAGUAACGGGGUAUCAGCGAUGUCCCCGUGAAUACGUUCUCGGGCCUUGCACACACCGCCCGUCACGCCACGGAAGUCGGUCCGGCCGGAAGUCCCCGAGCUAACCGGCCCUUUUUGGGCCGGGGGCAGGGGCCGAUGGCCGGGCCGGCGACUGGGGCGAAGUCGUAACAAGGUAGCCGUAGGGGAACCUGC',
                '>23S rRNA_T.thermophilus \nGGUCAAGAUGGUAAGGGCCCACGGUGGAUGCCUCGGCACCCGAGCCGAUGAAGGACGUGGCUACCUGCGAUAAGCCAGGGGGAGCCGGUAGCGGGCGUGGAUCCCUGGAUGUCCGAAUGGGGGAACCCGGCCGGCGGGAACGCCGGUCACCGCGCUUUUGCGCGGGGGGAACCUGGGGAACUGAAACAUCUCAGUACCCAGAGGAGAGGAAAGAGAAAUCGACUCCCUGAGUAGCGGCGAGCGAAAGGGGACCAGCCUAAACCGUCCGGCUUGUCCGGGCGGGGUCGUGGGGCCCUCGGACACCGAAUCCCCAGCCUAGCCGAAGCUGUUGGGAAGCAGCGCCAGAGAGGGUGAAAGCCCCGUAGGCGAAAGGUGGGGGGAUAGGUGAGGGUACCCGAGUACCCCGUGGUUCGUGGAGCCAUGGGGGAAUCUGGGCGGACCACCGGCCUAAGGCUAAGUACUCCGGGUGACCGAUAGCGCACCAGUACCGUGAGGGAAAGGUGAAAAGAACCCCGGGAGGGAGUGAAAUAGAGCCUGAAACCGUGGGCUUACAAGCAGUCACGGCCCCGCAAGGGGUUGUGGCGUGCCUAUUGAAGCAUGAGCCGGCGACUCACGGUCGUGGGCGAGCUUAAGCCGUUGAGGCGGAGGCGUAGGGAAACCGAGUCCGAACAGGGCGCAAGCGGGCCGCACGCGGCCCGCAAAGUCCGCGGCCGUGGACCCGAAACCGGGCGAGCUAGCCCUGGCCAGGGUGAAGCUGGGGUGAGACCCAGUGGAGGCCCGAACCGGUGGGGGAUGCAAACCCCUCGGAUGAGCUGGGGCUAGGAGUGAAAAGCUAACCGAGCCCGGAGAUAGCUGGUUCUCCCCGAAAUGACUUUAGGGUCAGCCUCAGGCGCUGACUGGGGCCUGUAGAGCACUGAUAGGGCUAGGGGGCCCACCAGCCUACCAAACCCUGUCAAACUCCGAAGGGUCCCAGGUGGAGCCUGGGAGUGAGGGCGCGAGCGAUAACGUCCGCGUCCGAGCGCGGGAACAACCGAGACCGCCAGCUAAGGCCCCCAAGUCUGGGCUAAGUGGUAAAGGAUGUGGCGCCGCGAAGACAGCCAGGAGGUUGGCUUAGAAGCAGCCAUCCUUUAAAGAGUGCGUAAUAGCUCACUGGUCGAGUGGCGCCGCGCCGAAAAUGAUGCGGGGCUUAAGCCCAGCGCCGAAGCUGCGGGUCUGGGGGAUGACCCCAGGCGGUAGGGGAGCGUUCCCGAUGCCGAUGAAGGCCGACCCGCGAGGCGGCUGGAGGUAAGGGAAGUGCGAAUGCCGGCAUGAGUAACGAUAAAGAGGGUGAGAAUCCCUCUCGCCGUAAGCCCAAGGGUUCCUACGCAAUGGUCGUCAGCGUAGGGUUAGGCGGGACCUAAGGUGAAGCCGAAAGGCGUAGCCGAAGGGCAGCCGGUUAAUAUUCCGGCCCUUCCCGCAGGUGCGAUGGGGGGACGCUCUAGGCUAGGGGGACCGGAGCCAUGGACGAGCCCGGCCAGAAGCGCAGGGUGGGAGGUAGGCAAAUCCGCCUCCCAACAAGCUCUGCGUGGUGGGGAAGCCCGUACGGGUGACAACCCCCCGAAGCCAGGGAGCCAAGAAAAGCCUCUAAGCACAACCUGCGGGAACCCGUACCGCAAACCGACACAGGUGGGCGGGUGCAAGAGCACUCAGGCGCGCGGGAGAACCCUCGCCAAGGAACUCUGCAAGUUGGCCCCGUAACUUCGGGAGAAGGGGUGCUCCCUGGGGUGAUGAGCCCCGGGGAGCCGCAGUGAACAGGCUCUGGCGACUGUUUACCAAAAACACAGCUCUCUGCGAACUCGUAAGAGGAGGUAUAGGGAGCGACGCUUGCCCGGUGCCGGAAGGUCAAGGGGAGGGGUGCAAGCCCCGAACCGAAGCCCCGGUGAACGGCGGCCGUAACUAUAACGGUCCUAAGGUAGCGAAAUUCCUUGUCGGGUAAGUUCCGACCUGCACGAAAAGCGUAACGACCGGAGCGCUGUCUCGGCGAGGGACCCGGUGAAAUUGAACUGGCCGUGAAGAUGCGGCCUACCCGUGGCAGGACGAAAAGACCCCGUGGAGCUUUACUGCAGCCUGGUGUUGGCUCUUGGUCGCGCCUGCGUAGGAUAGGUGGGAGCCUGUGAACCCCCGCCUCCGGGUGGGGGGGAGGCGCCGGUGAAAUACCACCCUGGCGCGGCUGGGGGCCUAACCCUCGGAUGGGGGGACAGCGCUUGGCGGGCAGUUUGACUGGGGCGGUCGCCUCCUAAAAGGUAACGGAGGCGCCCAAAGGUCCCCUCAGGCGGGACGGAAAUCCGCCGGAGAGCGCAAGGGUAGAAGGGGGCCUGACUGCGAGGCCUGCAAGCCGAGCAGGGGCGAAAGCCGGGCCUAGUGAACCGGUGGUCCCGUGUGGAAGGGCCAUCGAUCAACGGAUAAAAGUUACCCCGGGGAUAACAGGCUGAUCUCCCCCGAGCGUCCACAGCGGCGGGGAGGUUUGGCACCUCGAUGUCGGCUCGUCGCAUCCUGGGGCUGAAGAAGGUCCCAAGGGUUGGGCUGUUCGCCCAUUAAAGCGGCACGCGAGCUGGGUUCAGAACGUCGUGAGACAGUUCGGUCUCUAUCCGCCACGGGCGCAGGAGGCUUGAGGGGGGCUCUUCCUAGUACGAGAGGACCGGAAGGGACGCACCUCUGGUUUCCCAGCUGUCCCUCCAGGGGCAUAAGCUGGGUAGCCAUGUGCGGAAGGGAUAACCGCUGAAAGCAUCUAAGCGGGAAGCCCGCCCCAAGAUGAGGCCUCCCACGGCGUCAAGCCGGUAAGGACCCGGGAAGACCACCCGGUGGAUGGGCCGGGGGUGUAAGCGCCGCGAGGCGUUGAGCCGACCGGUCCCAAUCGUCCGAGGUCUUGACCCCUC'];

    document.getElementById('seqInput').value = seqs[idx];
    document.getElementById('beamSize').value = '100';
    document.getElementById("constrBox").checked = false;
    $('#constrant_intro').hide()
}

function sampleInputs(idx){
    var  seqs = ['>Babe.bige._GSP-5866.seq \nACCCGGCUUUUGCUGUAACUCUUCUGAGGGGUGCUGGCUUGAACCCAGUGGGCUGUCAUGCUGGCGCGUCCUUGCGCUGGGCUGUCUGGCGCGGGCGGGAGUCGUCCUUGGUGGCCUUCCGUAGGGGAGGCUUCCGGGUCGUUGAAUGCGGCGUACCGCUUCAGGCUGGCAACAGAGCAGAGAUAAGCUUCAGCUUCCGCUACGCGGCAGACCGCAGCCCGCGCUGCUCGCAGUCCAUCAUCGUCAGGCCCCCCACCGGUGAACUUGCCCGCUAUUUUUU \n>Enta.hist._AF487684.seq \nGAUCCUAUCAUAUUUAUCAACGUUUGAGACUACCUCAUACCAUAUCUUCGUACUUCAUUACUAGAUAUACGUAGGUAGAUUUAGUGCGGAAGUAACGAACAGGGUACUGCGUGAGGCCGGUUACGGAGCAACGAAAACCUGUCUACGAUGAUAGACCUGGGUUGAUAUGGAUGUCAAGUUAAUACCUAUGCUAGUAUUGGAACUAAUUUU \n>Leis.infa._AM502223.seq \nGCCGGAGCUCAGCUCUGUAACCGUCGGGGGCUAAUCAGGCUUAGCGGGGAGGACGUGGACCAGCGAGGGUGACGCGCUGCGUUGACGUGGUGCUCUGCUUGGCUGUGUGUCGGUGUGACCCGCACCCCUGCAGAGGGGUGGCGCGGGCCCGCCGUUGAAGCGAGGGAACCGGGUCAGGCCGGAAACGGAGCAGCCCACCCCGCGCACGUCCGCCGUUGCAGAAUCACACCGCGGAGCAUGUCCGCACUUGAGCCCCACGCCUCGUCGCAAAGCCUUUUU \n>Tetr.ther._X56981.seq \nGCCAGGGUAGCAAUACCUGUGUCUAUAUGUGGCAUAAACAAUGUAGGUUGUGAUAGAUAGGAUAUGAGAGUUUGAUGAGACAGUUUGCUAAGAGUGUGCCCGCUCCAAACAAUGAGUUGCUAUGGUGGUAACCUAGUAAUAGGACUCCACCAGGGCAUUAAAGAGCUAAGGAAACGCCUCAGGCUGGCAACAGAACAGGGAAAACUUGCCGCUUGUUGUGGUGGAAGGAUAACAUACUCAUUAACUGUCAAACUAAUCGGUUCUACUAUCAAAGCCAGACAUU \n>Tryp.bruc._AF047723.seq \nAGCCGGAGCGCAUUGCUCUGUAACCUUCGGGGGCUGAUCCCGCUUAGCGGGGACGUCUUGGACAAGCGGGGGUUCUGUUGCGUUGACUUGGUGUUCUGCUUGGUUGCGUGUCGGUGUUGAGGUCGCCACUGUAGAGAGGCGUUCUCGCGCCGUUAAAGUGGGGGGAACGGGUCAGGCCGGUGACGGAGCAGCCCACCUUGCGCACGUUCCCGUUGCAGAAGCACACCGAGGAGCAUCUCAGGACUUUGCGCCCCAAGUGUCGUCGCGAGGCGG'];

    document.getElementById('seqInput').value = seqs[idx];
    $('#seqInput').css("color", "black");
    $('#submit').prop('disabled', false);
    // document.getElementById('beamSize').value = '100';
    //document.getElementById("constrBox").checked = false;
}
function loading(){
    console.log('loading gif');
    document.getElementById('loadingIMG').style = "display:block";
    //document.getElementById('loadingIMG').innerHTML = '<img src="loading1.gif" alt="Loading..." height="160"></img>';
    //document.getElementById('loadingIMG').innerHTML = '<img src="http://linearfold.eecs.oregonstate.edu:8080/static/img/loading1.gif" alt="Loading..." height="160"></img>';
    //document.getElementById('loadingIMG').innerHTML = '<img src="https://raw.githubusercontent.com/KaiboLiu/PairingWebDemo/master/img/loading1.gif" alt="Loading..." height="160"><img>';
    //document.getElementById('loadingIMG').src = "https://raw.githubusercontent.com/KaiboLiu/PairingWebDemo/master/img/loading1.gif";
    //document.getElementById('loadingIMG').height = 160;
}





window.onload = function(e){
    $('#jobID').val(Date.now().toString(36) + Math.random().toString(36).substring(7));
    // console.log($('#jobID').val());
}
